(self.webpackChunkdigital_security_reference=self.webpackChunkdigital_security_reference||[]).push([[459],{92137:function(e,t,r){"use strict";function n(e,t,r,n,o,a,s){try{var i=e[a](s),c=i.value}catch(u){return void r(u)}i.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var s=e.apply(t,r);function i(e){n(s,o,a,i,c,"next",e)}function c(e){n(s,o,a,i,c,"throw",e)}i(void 0)}))}}r.d(t,{Z:function(){return o}})},87757:function(e,t,r){e.exports=r(35666)},83973:function(e,t,r){"use strict";r.d(t,{N:function(){return _}});var n=(...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const n of t){const e=Object.keys(n);if(r&&0!==r.size)for(const t of e){if(r.has(t))return!1;r.add(t)}else r=new Set(e)}return!0},o=r(83200);const a=new TextEncoder,s=new TextDecoder;function i(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}var c=r(35137);const u=e=>{let t=e;"string"==typeof t&&(t=a.encode(t));const r=[];for(let n=0;n<t.length;n+=32768)r.push(String.fromCharCode.apply(null,t.subarray(n,n+32768)));return c.Z.btoa(r.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")};var h=r(53541);var d=async(e,t,r)=>{const n=await function(e,t,r){if((0,h.b)(t))return t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError("symmetric keys are only applicable for HMAC-based algorithms");return h.Z.subtle.importKey("raw",t,{hash:{name:`SHA-${e.substr(-3)}`},name:"HMAC"},!1,[r])}throw new TypeError("invalid key input")}(e,t,"sign");((e,t)=>{if(e.startsWith("HS")){const r=parseInt(e.substr(-3),10),{length:n}=t.algorithm;if("number"!=typeof n||n<r)throw new TypeError(`${e} requires symmetric keys to be ${r} bits or larger`)}if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}})(e,n);const a=await h.Z.subtle.sign(function(e){switch(e){case"HS256":return{hash:{name:"SHA-256"},name:"HMAC"};case"HS384":return{hash:{name:"SHA-384"},name:"HMAC"};case"HS512":return{hash:{name:"SHA-512"},name:"HMAC"};case"PS256":return{hash:{name:"SHA-256"},name:"RSA-PSS",saltLength:32};case"PS384":return{hash:{name:"SHA-384"},name:"RSA-PSS",saltLength:48};case"PS512":return{hash:{name:"SHA-512"},name:"RSA-PSS",saltLength:64};case"RS256":return{hash:{name:"SHA-256"},name:"RSASSA-PKCS1-v1_5"};case"RS384":return{hash:{name:"SHA-384"},name:"RSASSA-PKCS1-v1_5"};case"RS512":return{hash:{name:"SHA-512"},name:"RSASSA-PKCS1-v1_5"};case"ES256":return{hash:{name:"SHA-256"},name:"ECDSA",namedCurve:"P-256"};case"ES384":return{hash:{name:"SHA-384"},name:"ECDSA",namedCurve:"P-384"};case"ES512":return{hash:{name:"SHA-512"},name:"ECDSA",namedCurve:"P-521"};default:throw new o.jq(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}(e),n,r);return new Uint8Array(a)};var l=(e,t)=>{if(e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||e.match(/^A\d{3}(?:GCM)KW$/)){if(t instanceof Uint8Array||"secret"===t.type)return;throw new TypeError('CryptoKey or KeyObject instances for symmetric algorithms must be of type "secret"')}if(t instanceof Uint8Array)throw new TypeError("CryptoKey or KeyObject instances must be used for asymmetric algorithms");if("secret"===t.type)throw new TypeError('CryptoKey or KeyObject instances for asymmetric algorithms must not be of type "secret"')};const f=function(e,t,r,n,a){if(void 0!==a.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let s;s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const i of n.crit){if(!s.has(i))throw new o.jq(`Extension Header Parameter "${i}" is not recognized`);if(void 0===a[i])throw new e(`Extension Header Parameter "${i}" is missing`);if(s.get(i)&&void 0===n[i])throw new e(`Extension Header Parameter "${i}" MUST be integrity protected`)}return new Set(n.crit)}.bind(void 0,o.GW,new Map([["b64",!0]]));var p=class{constructor(e){this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new o.GW("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!n(this._protectedHeader,this._unprotectedHeader))throw new o.GW("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader};let c=!0;if(f(null==t?void 0:t.crit,this._protectedHeader,r).has("b64")&&(c=this._protectedHeader.b64,"boolean"!=typeof c))throw new o.GW('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:h}=r;if("string"!=typeof h||!h)throw new o.GW('JWS "alg" (Algorithm) Header Parameter missing or invalid');l(h,e);let p,y=this._payload;c&&(y=a.encode(u(y))),p=this._protectedHeader?a.encode(u(JSON.stringify(this._protectedHeader))):a.encode("");const m=i(p,a.encode("."),y),g=await d(h,e,m),w={signature:u(g)};return c&&(w.payload=s.decode(y)),this._unprotectedHeader&&(w.header=this._unprotectedHeader),this._protectedHeader&&(w.protected=s.decode(p)),w}};var y=class{constructor(e){this._flattened=new p(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}},m=e=>Math.floor(e.getTime()/1e3);const g=86400,w=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;var v=e=>{const t=w.exec(e);if(!t)throw new TypeError("invalid time period format");const r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(r*g);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}};class _ extends class{constructor(e){if(!function(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return this._payload="number"==typeof e?{...this._payload,nbf:e}:{...this._payload,nbf:m(new Date)+v(e)},this}setExpirationTime(e){return this._payload="number"==typeof e?{...this._payload,exp:e}:{...this._payload,exp:m(new Date)+v(e)},this}setIssuedAt(e){return this._payload=void 0===e?{...this._payload,iat:m(new Date)}:{...this._payload,iat:e},this}}{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;const n=new y(a.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),(null===(r=this._protectedHeader.crit)||void 0===r?void 0:r.includes("b64"))&&!1===this._protectedHeader.b64)throw new o.uv("JWTs MUST NOT use unencoded payload");return n.sign(e,t)}}},35137:function(e,t){"use strict";t.Z=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;throw new Error("unable to locate global object")}()},53541:function(e,t,r){"use strict";r.d(t,{b:function(){return o}});var n=r(35137);function o(e){return void 0!==n.Z.CryptoKey&&(null!=e&&e instanceof n.Z.CryptoKey)}t.Z=n.Z.crypto},83200:function(e,t,r){"use strict";r.d(t,{jq:function(){return s},GW:function(){return u},uv:function(){return h}});class n extends Error{constructor(e){super(e),this.code=n.code,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}n.code="ERR_JOSE_GENERIC";class o extends n{constructor(e,t="unspecified",r="unspecified"){super(e),this.code=o.code,this.claim=t,this.reason=r}}o.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class a extends n{constructor(){super(...arguments),this.code=a.code}}a.code="ERR_JOSE_ALG_NOT_ALLOWED";class s extends n{constructor(){super(...arguments),this.code=s.code}}s.code="ERR_JOSE_NOT_SUPPORTED";class i extends n{constructor(){super(...arguments),this.code=i.code,this.message="decryption operation failed"}}i.code="ERR_JWE_DECRYPTION_FAILED";class c extends n{constructor(){super(...arguments),this.code=c.code}}c.code="ERR_JWE_INVALID";class u extends n{constructor(){super(...arguments),this.code=u.code}}u.code="ERR_JWS_INVALID";class h extends n{constructor(){super(...arguments),this.code=h.code}}h.code="ERR_JWT_INVALID";class d extends n{constructor(){super(...arguments),this.code=d.code}}d.code="ERR_JWK_INVALID";class l extends n{constructor(){super(...arguments),this.code=l.code}}l.code="ERR_JWKS_INVALID";class f extends n{constructor(){super(...arguments),this.code=f.code,this.message="no applicable key found in the JSON Web Key Set"}}f.code="ERR_JWKS_NO_MATCHING_KEY";class p extends n{constructor(){super(...arguments),this.code=p.code,this.message="multiple matching keys found in the JSON Web Key Set"}}p.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class y extends n{constructor(){super(...arguments),this.code=y.code,this.message="signature verification failed"}}y.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";class m extends o{constructor(){super(...arguments),this.code=m.code}}m.code="ERR_JWT_EXPIRED"},53416:function(e,t,r){"use strict";r.d(t,{K:function(){return s}});var n=r(53541),o=r(83200);var a=n.Z.getRandomValues.bind(n.Z);async function s(e,t){return async function(e,t){var r;let s,i,c;switch(e){case"HS256":case"HS384":case"HS512":s=parseInt(e.substr(-3),10),i={name:"HMAC",hash:{name:`SHA-${e.substr(-3)}`},length:s},c=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return s=parseInt(e.substr(-3),10),a(new Uint8Array(s>>3));case"A128KW":case"A192KW":case"A256KW":s=parseInt(e.substring(1,4),10),i={name:"AES-KW",length:s},c=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":s=parseInt(e.substring(1,4),10),i={name:"AES-GCM",length:s},c=["encrypt","decrypt"];break;default:throw new o.jq('unsupported or invalid JWK "alg" (Algorithm) Parameter value')}return n.Z.subtle.generateKey(i,null!==(r=null==t?void 0:t.extractable)&&void 0!==r&&r,c)}(e,t)}},35666:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",i=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(T){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new C(n||[]);return a._invoke=function(e,t,r){var n=d;return function(o,a){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw a;return R()}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var i=H(s,r);if(i){if(i===y)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var c=h(e,t,r);if("normal"===c.type){if(n=r.done?p:l,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(e,r,s),a}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(T){return{type:"throw",arg:T}}}e.wrap=u;var d="suspendedStart",l="suspendedYield",f="executing",p="completed",y={};function m(){}function g(){}function w(){}var v={};v[a]=function(){return this};var _=Object.getPrototypeOf,S=_&&_(_(P([])));S&&S!==r&&n.call(S,a)&&(v=S);var b=w.prototype=m.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(o,a,s,i){var c=h(e[o],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,i)}))}i(c.arg)}var o;this._invoke=function(e,n){function a(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(a,a):a()}}function H(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,H(e,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=h(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:R}}function R(){return{value:t,done:!0}}return g.prototype=b.constructor=w,w.constructor=g,g.displayName=c(w,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},E(A.prototype),A.prototype[s]=function(){return this},e.AsyncIterator=A,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var s=new A(u(t,r,n,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(b),c(b,i,"Generator"),b[a]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=P,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return i.type="throw",i.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],i=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,y):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}(e.exports);try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}}}]);